<!-- Common imports -->
<link rel="import" href="../../polymer/polymer.html" />
<link rel="import" href="../../promise-polyfill/promise-polyfill-lite.html" />
<link rel="import" href="../../px-icon-set/px-icon-set.html" />

<!-- Common demo imports -->
<link rel="import" href="../../px-demo/px-demo-header.html" />
<link rel="import" href="../../px-demo/px-demo-api-viewer.html" />
<link rel="import" href="../../px-demo/px-demo-footer.html" />
<link rel="import" href="../../px-demo/px-demo-configs.html" />
<link rel="import" href="../../px-demo/px-demo-props.html" />
<link rel="import" href="../../px-demo/px-demo-interactive.html" />
<link rel="import" href="../../px-demo/px-demo-component-snippet.html" />
<link rel="import" href="../../px-demo/px-demo-code-editor.html" />
<link rel="import" href="../../px-demo/css/px-demo-styles.html" />
<link rel="import" href="../../px-theme/px-theme-styles.html" />
<custom-style>
  <style include="px-theme-styles" is="custom-style"></style>
</custom-style>

<!-- Imports for this component -->
<link rel="import" href="../px-vis-heatmap.html" />
<!-- Demo DOM module -->
<dom-module id="px-vis-heatmap-demo">
  <template>

    <!-- Header -->
    <px-demo-header
      module-name="px-vis-heatmap"
      description="The px-vis-heatmap component"
      desktop>
    </px-demo-header>

    <!-- Interactive -->
    <px-demo-interactive>
      <!-- Configs -->
      <px-demo-configs slot="px-demo-configs" configs="[[configs]]" props="{{props}}" chosen-config="{{chosenConfig}}"></px-demo-configs>

      <!-- Props -->
      <px-demo-props slot="px-demo-props" props="{{props}}" config="[[chosenConfig]]"></px-demo-props>

      <!-- Code Editor -->
      <px-demo-code-editor slot="px-demo-code-editor" props="{{props}}" config="[[chosenConfig]]"></px-demo-code-editor>

      <!-- Component ---------------------------------------------------------->
      <px-demo-component slot="px-demo-component" class="flex" style="width:100%;">
        <px-vis-heatmap
          width="[[props.width.value]]"
          height="[[props.height.value]]"
          margin="[[props.margin.value]]"
          chart-data="[[props.chartData.value]]"
          chart-extents="[[props.chartExtents.value]]"
          colors="[[props.colors.value]]"
          series-config="[[props.seriesConfig.value]]"
          scale-padding="[[props.scalePadding.value]]"
          padding-outer="[[props.paddingOuter.value]]"
          show-cell-value="[[props.showCellValue.value]]"
          x-axis-config="[[props.xAxisConfig.value]]"
          y-axis-config="[[props.yAxisConfig.value]]"
          tooltip-delay="[[props.tooltipDelay.value]]">
        </px-vis-heatmap>
        <div>
          <input id="xSize" placeholder="X Size" />
          <input id="ySize" placeholder="Y Size" />
          <button on-click="_generateRandomData">Generate Data</button>
        </div>
      </px-demo-component>
      <!-- END Component ------------------------------------------------------>

      <px-demo-component-snippet
        slot="px-demo-component-snippet"
        element-properties="{{props}}"
        element-name="px-vis-heatmap"
        codepen-link="https://glitch.com/edit/#!/px-vis-heatmap-demo">
      </px-demo-component-snippet>
    </px-demo-interactive>

    <!-- API Viewer -->
    <px-demo-api-viewer
      source="px-vis-heatmap"
      api-source-file-path="px-vis-heatmap-api.json">
    </px-demo-api-viewer>

    <!-- Footer -->
    <px-demo-footer></px-demo-footer>

  </template>

</dom-module>
<script>
  Polymer({
    is: 'px-vis-heatmap-demo',

    ready: function() {
      // TODO: remove - using for easier dev
      window.chart = this.shadowRoot.querySelector('px-vis-heatmap');
    },

    properties: {
      props: {
        type: Object,
        value: function() {
          return this.demoProps;
        }
      },

      configs: {
        type: Array,
        value: function() {
          return [{
            configName: 'Default',
            configReset: true
          }];
        }
      }
    },

    /**
     * A reference for `this.props`. Read the documentation there.
     */
    demoProps: {
      width: {
        type: Number,
        inputType: 'number',
        defaultValue: 400
      },

      height: {
        type: Number,
        inputType: 'number',
        defaultValue: 400
      },

      margin: {
        type: Object,
        defaultValue: {
          'top': 10,
          'right': 10,
          'bottom': 70,
          'left': 70
        }
      },

      chartData: {
        type: Array,
        inputType: 'code:JSON',
        defaultValue: [
          {
            x: 'Cat A',
            y: 'Cat 1',
            value: 0
          },
          {
            x: 'Cat A',
            y: 'Cat 2',
            value: 10
          },
          {
            x: 'Cat A',
            y: 'Cat 3',
            value: 20
          },
          {
            x: 'Cat B',
            y: 'Cat 1',
            value: 30
          },
          {
            x: 'Cat B',
            y: 'Cat 2',
            value: 40
          },
          {
            x: 'Cat B',
            y: 'Cat 3',
            value: 50
          },
          {
            x: 'Cat C',
            y: 'Cat 1',
            value: 65
          },
          {
            x: 'Cat C',
            y: 'Cat 2',
            value: 75
          },
          {
            x: 'Cat C',
            y: 'Cat 3',
            value: 100
          },
        ]
      },

      chartExtents: {
        type: Object,
        inputType: 'code:JSON',
        defaultValue: {
          x: ['Cat A', 'Cat B', 'Cat C'],
          y: ['Cat 1', 'Cat 2', 'Cat 3'],
          value: [0, 100]
        }
      },

      colors: {
        type: Array,
        inputType: 'code:JSON',
        defaultValue: [
          'blue',
          'violet',
          'red'
        ]
      },

      seriesConfig: {
        type: Object,
        inputType: 'code:JSON',
        defaultValue: {
          'series1': {
            'name': 'Series 1',
            'x': 'x',
            'y': 'y',
            'value': 'value'
          }
        }
      },

      scalePadding: {
        type: Number,
        inputType: 'number',
        defaultValue: 0
      },

      paddingOuter: {
        type: Number,
        inputType: 'number',
        defaultValue: 0
      },

      showCellValue: {
        type: Boolean,
        inputType: 'toggle',
        defaultValue: true
      },

      tooltipDelay: {
        type: Number,
        inputType: 'number',
        defaultValue: 0
      },

      xAxisConfig: {
        type: Object,
        inputType: 'code:JSON',
        defaultValue: {
          title: 'X Axis Label',
          orientation: 'bottom',
          labelPosition: 'center'
        }
      },

      yAxisConfig: {
        type: Object,
        inputType: 'code:JSON',
        defaultValue: {
          title: 'Y Axis Label',
          orientation: 'left',
          labelPosition: 'center'
        }
      },

    },

    _generateRandomData: function() {
      const chart = this.shadowRoot.querySelector('px-vis-heatmap');
      const xSize = Number.parseInt(this.$.xSize.value);
      const ySize = Number.parseInt(this.$.ySize.value);
      if (Number.isInteger(xSize) && Number.isInteger(ySize)) {
        // update extents
        chart.set('chartExtents', this._generateChartExtents(xSize, ySize));
        // update data
        chart.set('chartData', this._generateData(xSize, ySize));
      }
    },

    _generateData: function(xNum, yNum) {
      const data = [];
      for (let x = 0; x < xNum; x++) {
        for (let y = 0; y < yNum; y++) {
          // increase values in a diaganol pattern
          const power = (x + y) / (xNum + yNum - 2);
          data.push({
            x: x,
            y: y,
            value: Math.round(100 * power)
          });
        }
      }
      return data;
    },

    _generateChartExtents: function(xNum, yNum) {
      const exts = {
        x: [],
        y: [],
        value: [0, 100]
      };
      for (let i = 0; i < xNum; i++) {
        exts.x.push(i);
      }
      for (let i = 0; i < yNum; i++) {
        exts.y.push(i);
      }
      return exts;
    }

  });

</script>
